<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Activity Royale - Pro</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    
    <style>
        :root {
            --primary: #ff512f; --secondary: #dd2476;
            --blue-team: #00d2ff; --red-team: #ff4b2b;
            --glass: rgba(255, 255, 255, 0.1);
        }
        body {
            margin: 0; padding: 10px; font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: white; min-height: 100vh; display: flex; flex-direction: column; align-items: center;
        }

        /* –î–∏—Å–∫—Ä–µ—Ç–µ–Ω –±—É—Ç–æ–Ω –∑–∞ —Ä–µ—Å–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ */
        .admin-controls { width: 100%; max-width: 600px; display: flex; justify-content: flex-end; margin-bottom: 5px; }
        .score-reset-btn { 
            background: rgba(206, 17, 17, 0.2); border: 1px solid rgba(255,255,255,0.1); 
            color: rgba(255,255,255,0.5); font-size: 0.7rem; padding: 5px 10px; border-radius: 5px; 
        }

        .scoreboard { display: flex; gap: 15px; margin-bottom: 15px; width: 100%; max-width: 600px; }
        .score-box { flex: 1; padding: 10px; border-radius: 15px; text-align: center; backdrop-filter: blur(10px); border: 2px solid rgba(255,255,255,0.1); }
        .blue { background: rgba(0, 210, 255, 0.2); border-color: var(--blue-team); }
        .red { background: rgba(255, 75, 43, 0.2); border-color: var(--red-team); }
        .score-number { font-size: 2.2rem; font-weight: bold; display: block; }
        
        .game-container { width: 95%; max-width: 650px; background: var(--glass); backdrop-filter: blur(15px); border-radius: 30px; padding: 20px; text-align: center; position: relative; }
        h1 { font-size: 1.6rem; min-height: 65px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .dice-result { color: #00ffcc; font-size: 2.8rem; }
        
        .decks { display: flex; gap: 15px; justify-content: center; margin: 20px 0; min-height: 220px; align-items: center; }
        .decks.locked { opacity: 0.3; pointer-events: none; filter: grayscale(1); }
        
        .deck-container { width: 130px; height: 190px; perspective: 1000px; cursor: pointer; transition: 0.4s; }
        .deck-container.selected { width: 310px; height: 430px; z-index: 10; }
        .deck-container.hidden { width: 0; opacity: 0; margin: 0; pointer-events: none; }
        
        .deck { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: 0.7s; }
        .deck.flipped { transform: rotateY(180deg); }
        .deck-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 20px; border: 2px solid rgba(255,255,255,0.2); }
        .deck-face img { width: 100%; height: 100%; object-fit: cover; }
        .deck-back { transform: rotateY(180deg); background: white; color: #222; display: flex; align-items: center; justify-content: center; }
        
        .card-content { padding: 25px; font-weight: bold; font-size: 1.7rem; text-align: left; width: 100%; }
        .card-content div { border-bottom: 2px solid #f0f0f0; padding: 12px 0; }
        
        #success-area { display: none; margin: 15px 0; flex-direction: column; gap: 10px; }
        .btn-success { background: linear-gradient(45deg, #00b09b, #96c93d); padding: 18px; font-size: 1.4rem; border-radius: 15px; border: none; color: white; font-weight: bold; cursor: pointer; }
        
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        button { padding: 15px; border: none; border-radius: 15px; font-weight: bold; color: white; cursor: pointer; }
        
        /* –°—Ç–∏–ª –∑–∞ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–∞–Ω —Ç–∞–π–º–µ—Ä */
        .timer-btn { background: linear-gradient(45deg, #f09819, #edde5d); color: #222; }
        .timer-btn:disabled { background: #555; color: #888; cursor: not-allowed; opacity: 0.5; }
        
        .dice-btn { background: linear-gradient(45deg, var(--primary), var(--secondary)); }
        .reset-btn { background: #444; grid-column: span 2; }
        
        .timer-display { font-size: 4.5rem; color: #00ffcc; font-family: monospace; font-weight: bold; }
    </style>
</head>
<body>

<div class="admin-controls" style="width: 100%; max-width: 600px; display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center;">
    <a href="index.html" style="text-decoration: none;">
        <button class="score-reset-btn" style="background: rgba(0, 210, 255, 0.2); border: 1px solid rgba(0, 210, 255, 0.3); color: #00d2ff;">
            üè† –ì–õ–ê–í–ù–û –ú–ï–ù–Æ
        </button>
    </a>

    <button class="score-reset-btn" onclick="resetScores()">
        –ù–£–õ–ò–†–ê–ô –†–ï–ó–£–õ–¢–ê–¢–ê (0:0)
    </button>
</div>

<div class="scoreboard">
    <div class="score-box blue"><span>–°–ò–ù–ò</span><span class="score-number" id="score-blue">0</span></div>
    <div class="score-box red"><span>–ß–ï–†–í–ï–ù–ò</span><span class="score-number" id="score-red">0</span></div>
</div>

<div class="game-container">
    <h1 id="game-title">üéÆ My Activity</h1>
    
    <div class="decks locked" id="decks-wrapper">
        <div class="deck-container" id="d3" onclick="selectDeck(3, this)"><div class="deck"><div class="deck-face"><img src="3 back.png"></div><div class="deck-face deck-back"></div></div></div>
        <div class="deck-container" id="d4" onclick="selectDeck(4, this)"><div class="deck"><div class="deck-face"><img src="4 back.png"></div><div class="deck-face deck-back"></div></div></div>
        <div class="deck-container" id="d5" onclick="selectDeck(5, this)"><div class="deck"><div class="deck-face"><img src="5 back.png"></div><div class="deck-face deck-back"></div></div></div>
    </div>

    <div id="success-area">
        <button id="success-label" class="btn-success" onclick="stopTimerAndShowScore()">‚úÖ –ü–û–ó–ù–ê–¢–û!</button>
        <div id="score-selection" style="display:none; gap:10px; margin-top:10px;">
            <button id="add-blue" style="background:var(--blue-team); flex:1" onclick="addPoint('blue')"></button>
            <button id="add-red" style="background:var(--red-team); flex:1" onclick="addPoint('red')"></button>
        </div>
    </div>

    <div class="controls">
        <button id="dice-btn" class="dice-btn" onclick="rollDice()">üé≤ –ó–ê–†–ß–ï</button>
        <button id="t-btn" class="timer-btn" onclick="startTimer()" disabled>‚è± –°–¢–ê–†–¢ 60 –°–ï–ö</button>
        <button class="reset-btn" onclick="resetCloud()">üîÑ –°–õ–ï–î–í–ê–© –•–û–î</button>
    </div>

    <div class="timer-display" id="timer">60</div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyC98brPgVFU1QIFpE9Q8N61xDiarrFERhM",
        authDomain: "my-activity-d2bc5.firebaseapp.com",
        databaseURL: "https://my-activity-d2bc5-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "my-activity-d2bc5",
        storageBucket: "my-activity-d2bc5.firebasestorage.app",
        messagingSenderId: "940491408918",
        appId: "1:940491408918:web:c7b521d5e36f7711bc5737",
        measurementId: "G-NN76LJX7ET"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database().ref("game_session_private");

    let timerInterval = null;
    let currentLevelPoints = 0;
    let isCardSelected = false;

    const cards = {
        3: [{d:"–ú–æ—Å—Ç", a:"–ö–æ–ª–µ–±–∞–µ—à —Å–µ", s:"–û—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç"},
        {d:"–ü–ª–∞–Ω–∏–Ω–∞", a:"–†–µ—à–∞–≤–∞—à", s:"–î–æ–≤–µ—Ä–∏–µ"},
        {d:"–ö–∞—Ä—Ç–∞", a:"–û–±—ä—Ä–∫–∞–Ω", s:"–ü—Ä–æ–≤–∞–ª"},
        {d:"–ö–æ—Ä–∞–±", a:"–°—ä–º–Ω—è–≤–∞—à —Å–µ", s:"–ù–∞–≤–∏–∫"},
        {d:"–ß–∞—Å–æ–≤–Ω–∏–∫", a:"–ü–∞–Ω–∏–∫–∞", s:"–ù–∞—Ç–∏—Å–∫"},
        {d:"–õ–∞–±–∏—Ä–∏–Ω—Ç", a:"–¢—ä—Ä–ø–µ–ª–∏–≤", s:"–ë–∞–ª–∞–Ω—Å"},
        {d:"–ü–ª–∞–∂", a:"–í–ª—é–±–µ–Ω", s:"–ì—Ä–∞–Ω–∏—Ü–∞"},
        {d:"–°—è–Ω–∫–∞", a:"–Ø–¥–æ—Å–∞–Ω", s:"–ü—Ä–∏–Ω—Ü–∏–ø"},
        {d:"–ö—É–ª–∞", a:"–°–ø–æ–∫–æ–µ–Ω", s:"–ü–æ—Å–ª–µ–¥–∏—Ü–∞"},
        {d:"–ú–∞—Å–∫–∞", a:"–ü—Ä–µ—Å—Ç—Ä—É–≤–∞—à —Å–µ", s:"–ò—Å—Ç–∏–Ω–∞"},
        {d:"–í—ä–ª–Ω–∞", a:"–û—á–∞–∫–≤–∞—à", s:"–ò–∑–±–æ—Ä"},
        {d:"–í–µ–∑–Ω–∏", a:"–°—Ä–∞–≤–Ω—è–≤–∞—à", s:"–ö–æ–º–ø—Ä–æ–º–∏—Å"},
        {d:"–ö—Ä—ä–≥", a:"–û—Ç–∫–∞–∑–≤–∞—à", s:"–ü—Ä–∏—á–∏–Ω–∞"},
        {d:"–°—Ç—ä–ª–±–∞", a:"–û–ø–∏—Ç–≤–∞—à", s:"–†–µ–∑—É–ª—Ç–∞—Ç"},
        {d:"–ü—ä–∑–µ–ª", a:"–¢—ä—Ä–∂–µ—Å—Ç–≤—É–≤–∞—à", s:"–ì–æ—Ä–¥–æ—Å—Ç"},
        {d:"–ö–ª–µ—Ç–∫–∞", a:"–ë—è–≥–∞—à", s:"–°–≤–æ–±–æ–¥–∞"},
        {d:"–õ–∏–Ω–∏—è", a:"–°–ø–∏—Ä–∞—à", s:"–ì—Ä–∞–Ω–∏—Ü–∞"},
        {d:"–§–ª–∞–≥", a:"–ó–∞—â–∏—Ç–∞–≤–∞—à", s:"–ü–æ–∑–∏—Ü–∏—è"},
        {d:"–í—Ä–∞—Ç–∞", a:"–°—ä–º–Ω—è–≤–∞—à —Å–µ", s:"–í—è—Ä–∞"},
        {d:"–û–≥—ä–Ω", a:"–†–∏—Å–∫—É–≤–∞—à", s:"–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ"},
        {d:"–ü—ä—Ç", a:"–ò–∑–±–∏—Ä–∞—à", s:"–ù–∞—Å–æ–∫–∞"},
        {d:"–†–∞–º–∫–∞", a:"–û–≥–ª–µ–∂–¥–∞—à", s:"–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞"},
        {d:"–ö–ª—é—á", a:"–û—Ç–∫–∞–∑", s:"–†–µ—à–µ–Ω–∏–µ"},
        {d:"–°—Ñ–µ—Ä–∞", a:"–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞—à", s:"–ù–∞—Ç–∏—Å–∫"},
        {d:"–°—Ç–µ–Ω–∞", a:"–°–ø–∏—Ä–∞—à", s:"–ü—Ä–µ—á–∫–∞"},
        {d:"–ú—Ä–µ–∂–∞", a:"–°–≤—ä—Ä–∑–≤–∞—à", s:"–ö–æ–Ω—Ç–∞–∫—Ç"},
        {d:"–ü—è—Å—ä–∫", a:"–ò–∑–ø—É—Å–∫–∞—à", s:"–í—Ä–µ–º–µ"},
        {d:"–ö–æ–º–ø–∞—Å", a:"–ù–∞—Å–æ—á–≤–∞—à", s:"–ü–æ—Å–æ–∫–∞"},
        {d:"–õ—ä–∫", a:"–¶–µ–ª–∏—à", s:"–ê–º–±–∏—Ü–∏—è"},
        {d:"–ö–ª—é—á–∞–ª–∫–∞", a:"–ü–∞–∑–∏—à", s:"–¢–∞–π–Ω–∞"},
        {d:"–¢–æ–ø–∫–∞", a:"–ü–æ–¥—Ö–≤—ä—Ä–ª—è—à", s:"–®–∞–Ω—Å"},
        {d:"–ü–ª–∞—Ç–Ω–æ", a:"–°—ä–∑–¥–∞–≤–∞—à", s:"–ò–¥–µ—è"},
        {d:"–ö–≤–∞–¥—Ä–∞—Ç", a:"–ü–æ–¥—Ä–µ–∂–¥–∞—à", s:"–†–µ–¥"},
        {d:"–ö–æ—Ä–∞", a:"–ó–∞—â–∏—Ç–∞–≤–∞—à", s:"–°–∏–≥—É—Ä–Ω–æ—Å—Ç"},
        {d:"–°—Ç—Ä–µ–ª–∫–∞", a:"–ù–∞—Å–æ—á–≤–∞—à", s:"–¶–µ–ª"},
        {d:"–°–∞–Ω–¥—ä–∫", a:"–û—Ç–∫—Ä–∏–≤–∞—à", s:"–ò–∑–Ω–µ–Ω–∞–¥–∞"},
        {d:"–ü–∞—Ä–∞—à—É—Ç", a:"–ü–∞–¥–∞—à", s:"–†–∏—Å–∫"},
        {d:"–ö–∞–º—ä–∫", a:"–£–ø–æ—Ä—Å—Ç–≤–∞—à", s:"–ò–Ω–∞—Ç"},
        {d:"–ú–æ—Å—Ç", a:"–°–≤—ä—Ä–∑–≤–∞—à", s:"–ö–æ–º–ø—Ä–æ–º–∏—Å"},
        {d:"–õ–∞–±–∏—Ä–∏–Ω—Ç", a:"–ì—É–±–∏—à —Å–µ", s:"–¢—ä—Ä—Å–µ–Ω–µ"}],
        //–¢–µ—Å—Ç–µ 4
        4: [{d:"–•–∞–æ—Å", a:"–ò–º–ø—Ä–æ–≤–∏–∑–∏—Ä–∞—à", s:"–°–º–∏—Å—ä–ª"},
        {d:"–ë–µ–∑–∫—Ä–∞–π–Ω–æ—Å—Ç", a:"–ì—É–±–∏—à –∫–æ–Ω—Ç—Ä–æ–ª", s:"–°—ä—â–Ω–æ—Å—Ç"},
        {d:"–ë–∞–ª–∞–Ω—Å", a:"–ö–æ–ª–µ–±–∞–µ—à", s:"–ò–∑–±–æ—Ä"},
        {d:"–ü–∞—Ä–∞–¥–æ–∫—Å", a:"–û—Ç—Ä–∏—á–∞—à", s:"–ò—Å—Ç–∏–Ω–∞"},
        {d:"–ì—Ä–∞–Ω–∏—Ü–∞", a:"–û–≥—Ä–∞–Ω–∏—á–µ–Ω", s:"–°–≤–æ–±–æ–¥–∞"},
        {d:"–¶–µ–Ω—Ç—ä—Ä", a:"–§–æ–∫—É—Å–∏—Ä–∞—à", s:"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç"},
        {d:"–û—Ç—Ä–∞–∂–µ–Ω–∏–µ", a:"–ò–º–∏—Ç–∏—Ä–∞—à", s:"–ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç"},
        {d:"–†–∞–∑–ª–æ–º", a:"–†–∞–∑–¥–µ–ª—è—à", s:"–ö–æ–Ω—Ñ–ª–∏–∫—Ç"},
        {d:"–ü—ä—Ç", a:"–õ—É—Ç–∞–Ω–µ", s:"–ü–æ—Å–æ–∫–∞"},
        {d:"–°–ø–∏—Ä–∞–ª–∞", a:"–ü–æ–≤—Ç–∞—Ä—è—à", s:"–¶–∏–∫—ä–ª"},
        {d:"–¢–µ–∂–µ—Å—Ç", a:"–ù–∞—Ç–∏—Å–∫", s:"–û—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç"},
        {d:"–ú—ä–≥–ª–∞", a:"–ù–µ—Å–∏–≥—É—Ä–Ω–æ—Å—Ç", s:"–°—ä–º–Ω–µ–Ω–∏–µ"},
        {d:"–í—Ä—ä—Ö", a:"–¢—Ä–∏—É–º—Ñ", s:"–£—Å–ø–µ—Ö"},
        {d:"–ü—Ä–∞–∑–Ω–æ—Ç–∞", a:"–ó–∞–º—Ä—ä–∑–≤–∞—à", s:"–õ–∏–ø—Å–∞"},
        {d:"–ò—Å–∫—Ä–∞", a:"–í—ä–∑–ø–ª–∞–º–µ–Ω—è–≤–∞—à", s:"–í–¥—ä—Ö–Ω–æ–≤–µ–Ω–∏–µ"},
        {d:"–ü—É–∫–Ω–∞—Ç–∏–Ω–∞", a:"–ü—Ä–µ—á—É–ø–≤–∞—à", s:"–ö—Ä–∞—Ö"},
        {d:"–¢–æ—á–∫–∞", a:"–°–ø–∏—Ä–∞—à", s:"–ö—Ä–∞–π"},
        {d:"–í—ä–ª–Ω–∞", a:"–ó–∞–≤–ª–∏—á–∞—à", s:"–í–ª–∏—è–Ω–∏–µ"},
        {d:"–û–≥—ä–Ω", a:"–£–Ω–∏—â–æ–∂–∞–≤–∞—à", s:"–ü—Ä–æ–º—è–Ω–∞"},
        {d:"–°—è–Ω–∫–∞", a:"–ö—Ä–∏–µ—à", s:"–°—Ç—Ä–∞—Ö"},
        {d:"–õ–∞–±–∏—Ä–∏–Ω—Ç", a:"–ë–ª—É–∂–¥–∞–µ—à", s:"–¢—ä—Ä—Å–µ–Ω–µ"},
        {d:"–ú–æ—Å—Ç", a:"–°–≤—ä—Ä–∑–≤–∞—à", s:"–î–∏–∞–ª–æ–≥"},
        {d:"–ö—Ä—ä–≥", a:"–ü–æ–≤—Ç–∞—Ä—è—à", s:"–ù–∞–≤–∏–∫"},
        {d:"–°—Ç–µ–Ω–∞", a:"–û—Ç–±–ª—ä—Å–∫–≤–∞—à", s:"–ì—Ä–∞–Ω–∏—Ü–∞"},
        {d:"–ö–ª—é—á", a:"–û—Ç–∫–ª—é—á–≤–∞—à", s:"–†–µ—à–µ–Ω–∏–µ"},
        {d:"–ü—Ä–æ–ø–∞—Å—Ç", a:"–ö–æ–ª–µ–±–∞–Ω–∏–µ", s:"–†–∏—Å–∫"},
        {d:"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞", a:"–ò–∑–¥–∏–≥–∞—à", s:"–í—ä–∑–º–æ–∂–Ω–æ—Å—Ç"},
        {d:"–ü—ä—Ç–µ–≤–æ–¥–∏—Ç–µ–ª", a:"–ù–∞—Å–æ—á–≤–∞—à", s:"–°–º–∏—Å—ä–ª"},
        {d:"–†–∞–º–∫–∞", a:"–û–≥—Ä–∞–Ω–∏—á–∞–≤–∞—à", s:"–ö–æ–Ω—Ç–µ–∫—Å—Ç"},
        {d:"–¢–µ–∂–µ—Å—Ç", a:"–ü—Ä–∏—Ç–∏—Å–∫–∞—à", s:"–ù–∞—Ç–∏—Å–∫"},
        {d:"–ó–Ω–∞–∫", a:"–ü–æ–∫–∞–∑–≤–∞—à", s:"–ó–Ω–∞—á–µ–Ω–∏–µ"},
        {d:"–ü—Ä–∞–≥", a:"–ü—Ä–µ–∫—Ä–∞—á–≤–∞—à", s:"–ù–∞—á–∞–ª–æ"},
        {d:"–í–µ—Ä–∏–≥–∞", a:"–ó–∞–¥—ä—Ä–∂–∞—à", s:"–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç"},
        {d:"–ú–∞—Å–∫–∞", a:"–ü—Ä–µ—Å—Ç—Ä—É–≤–∞—à", s:"–õ—ä–∂–∞"},
        {d:"–†–∏—Ç—ä–º", a:"–ü–æ–≤—Ç–∞—Ä—è—à", s:"–ü—Ä–æ—Ü–µ—Å"},
        {d:"–¢–æ—á–∫–∞", a:"–†–µ—à–∏—Ç–µ–ª–Ω–æ—Å—Ç", s:"–§–∏–Ω–∞–ª"},
        {d:"–ü–ª–∞–º—ä–∫", a:"–ò–º–ø—É–ª—Å", s:"–ñ–µ–ª–∞–Ω–∏–µ"},
        {d:"–ö–æ—Ä–µ–Ω", a:"–ó–∞–∑–µ–º—è–≤–∞—à", s:"–ü—Ä–æ–∏–∑—Ö–æ–¥"},
        {d:"–ö–æ–Ω—Ç—É—Ä", a:"–û—á–µ—Ä—Ç–∞–≤–∞—à", s:"–ì—Ä–∞–Ω–∏—Ü–∞"},
        {d:"–í—ä–∑–µ–ª", a:"–ó–∞–ø–ª–∏—Ç–∞—à", s:"–ü—Ä–æ–±–ª–µ–º"}],
        //–¢–µ—Å—Ç–µ 5
        5: [{d:"–°–∏–Ω–≥—É–ª—è—Ä–Ω–æ—Å—Ç", a:"–°–≤–∏–≤–∞—à —Å–µ", s:"–ë–µ–∑–∫—Ä–∞–π–Ω–æ—Å—Ç"},
        {d:"–ï–Ω—Ç—Ä–æ–ø–∏—è", a:"–†–∞–∑–ø–∞–¥–∞—à —Å–µ", s:"–•–∞–æ—Å"},
        {d:"–ü–æ–¥—Å—ä–∑–Ω–∞–Ω–∏–µ", a:"–ü—Ä–æ–ø–∞–¥–∞—à", s:"–°–∫—Ä–∏—Ç"},
        {d:"–ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è", a:"–î–µ—Ñ–æ—Ä–º–∏—Ä–∞—à", s:"–ò–¥–µ—è"},
        {d:"–í–∞–∫—É—É–º", a:"–ó–∞–¥—É—à–∞–≤–∞—à —Å–µ", s:"–ü—Ä–∞–∑–Ω–æ—Ç–∞"},
        {d:"–ê–ª–≥–æ—Ä–∏—Ç—ä–º", a:"–ú–µ—Ö–∞–Ω–∏—á–µ–Ω —Å–∏", s:"–õ–æ–≥–∏–∫–∞"},
        {d:"–ï–≤–æ–ª—é—Ü–∏—è", a:"–ü—Ä–æ–º–µ–Ω—è—à —Å–µ", s:"–†–∞–∑–≤–∏—Ç–∏–µ"},
        {d:"–ò–∑–∫—Ä–∏–≤—è–≤–∞–Ω–µ", a:"–ü—Ä–µ—á—É–ø–≤–∞—à", s:"–û–ø—Ç–∏—á–µ–Ω"},
        {d:"–ò–ª—é–∑–∏—è", a:"–ó–∞–±–ª—É–∂–¥–∞–≤–∞—à", s:"–í–∏–∑–∏—è"},
        {d:"–°–∏–º–±–∏–æ–∑–∞", a:"–°–ª–∏–≤–∞—à —Å–µ", s:"–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç"},
        {d:"–í–∏–±—Ä–∞—Ü–∏—è", a:"–¢—Ä–µ–ø–µ—Ä–∏—à", s:"–ß–µ—Å—Ç–æ—Ç–∞"},
        {d:"–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è", a:"–ü—Ä–∏–≤–ª–∏—á–∞—à", s:"–°–∏–ª–∞"},
        {d:"–ú–µ—Ç–∞–º–æ—Ä—Ñ–æ–∑–∞", a:"–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–∞—à", s:"–ö–∞–∫–∞–≤–∏–¥–∞"},
        {d:"–ü–∞—Ä–∞–ª–µ–ª", a:"–†–∞–≤–Ω–æ–≤–µ—Å–∏–µ", s:"–°—Ö–æ–¥—Å—Ç–≤–æ"},
        {d:"–†–µ–∑–æ–Ω–∞–Ω—Å", a:"–ï—Ö–æ", s:"–ó–≤—É–∫"},
        {d:"–§—Ä–∞–≥–º–µ–Ω—Ç", a:"–ß—É–ø–∏—à", s:"–ß–∞—Å—Ç"},
        {d:"–•–∏–ø–Ω–æ–∑–∞", a:"–ü—Ä–∏—Å–ø–∏–≤–∞—à", s:"–¢—Ä–∞–Ω—Å"},
        {d:"–ò–º–ø—É–ª—Å", a:"–¢–ª–∞—Å—ä–∫", s:"–†–µ–∞–∫—Ü–∏—è"},
        {d:"–ú–∏—Ä–∞–∂", a:"–ò–∑—á–µ–∑–≤–∞—à", s:"–ü—É—Å—Ç–∏–Ω—è"},
        {d:"–ï–Ω–∏–≥–º–∞", a:"–ó–∞–∫–ª—é—á–≤–∞—à", s:"–ó–∞–≥–∞–¥–∫–∞"},
        {d:"–ü—Ä–æ–µ–∫—Ü–∏—è", a:"–ò–∑–ª—ä—á–≤–∞—à", s:"–û–±—Ä–∞–∑"},
        {d:"–ë–∞–ª–∞–Ω—Å", a:"–ë–∞–ª–∞–Ω—Å–∏—Ä–∞—à", s:"–°—Ç–∞–±–∏–ª–Ω–æ—Å—Ç"},
        {d:"–ò–Ω–µ—Ä—Ü–∏—è", a:"–ü—Ä–æ–¥—ä–ª–∂–∞–≤–∞—à", s:"–î–≤–∏–∂–µ–Ω–∏–µ"},
        {d:"–í–∏–∑–∏—è", a:"–ü—Ä–µ–¥–≤–∏–∂–¥–∞—à", s:"–ë—ä–¥–µ—â–µ"},
        {d:"–ú–∞—Ç–µ—Ä–∏—è", a:"–û—Ñ–æ—Ä–º—è—à", s:"–§–∏–∑–∏–∫–∞"},
        {d:"–î—É—à–∞", a:"–õ–µ—Ç–∏—à", s:"–í—ä—Ç—Ä–µ—à–µ–Ω"},
        {d:"–í—Ä–µ–º–µ", a:"–ß–∞–∫–∞—à", s:"–í–µ—á–Ω–æ—Å—Ç"},
        {d:"–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ", a:"–†–∞–∑—à–∏—Ä—è–≤–∞—à", s:"–ö–æ—Å–º–æ—Å"},
        {d:"–ï–≥–æ", a:"–ì–æ—Ä–¥–µ–µ—à —Å–µ", s:"–õ–∏—á–Ω–æ—Å—Ç"},
        {d:"–ö–æ–Ω—Ñ–ª–∏–∫—Ç", a:"–°–±–ª—ä—Å–∫–≤–∞—à —Å–µ", s:"–ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ"},
        {d:"–ò–Ω—Ç—É–∏—Ü–∏—è", a:"–£—Å–µ—â–∞—à", s:"–ü—Ä–µ–¥—á—É–≤—Å—Ç–≤–∏–µ"},
        {d:"–ì–µ–Ω–µ—Ç–∏–∫–∞", a:"–ù–∞—Å–ª–µ–¥—è–≤–∞—à", s:"–î–ù–ö"},
        {d:"–ú–∏—Å—Ç–µ—Ä–∏—è", a:"–®–µ–ø–Ω–µ—à", s:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},
        {d:"–°—Ç—Ä—É–∫—Ç—É—Ä–∞", a:"–ì—Ä–∞–¥—è", s:"–û—Å–Ω–æ–≤–∞"},
        {d:"–ï—Ñ–µ–∫—Ç", a:"–°–ª–µ–¥—Å—Ç–≤–∏–µ", s:"–†–µ–∑—É–ª—Ç–∞—Ç"},
        {d:"–ü—Ä–∏—á–∏–Ω–∞", a:"–ù–∞—á–∞–ª–æ", s:"–û–±—è—Å–Ω–µ–Ω–∏–µ"},
        {d:"–°–∏—Å—Ç–µ–º–∞", a:"–°–≤—ä—Ä–∑–≤–∞—à", s:"–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è"},
        {d:"–¢–µ–æ—Ä–∏—è", a:"–ú–∏—Å–ª–∏—à", s:"–•–∏–ø–æ—Ç–µ–∑–∞"},
        {d:"–§–∞–∫—Ç", a:"–î–æ–∫–∞–∑–≤–∞—à", s:"–†–µ–∞–ª–Ω–æ—Å—Ç"},
        {d:"–ï–ª–µ–º–µ–Ω—Ç", a:"–°—ä–±–∏—Ä–∞—à", s:"–°—ä—Å—Ç–∞–≤–Ω–∞ —á–∞—Å—Ç"}]
    };

    const alarm = new Audio("https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg");

    db.on("value", (snap) => {
        const data = snap.val();
        if(!data) return;

        document.getElementById("score-blue").textContent = data.scores.blue;
        document.getElementById("score-red").textContent = data.scores.red;
        document.getElementById("timer").textContent = data.timer;
        document.getElementById("game-title").innerHTML = data.title;
        
        if(data.cardsLocked) document.getElementById("decks-wrapper").classList.add("locked");
        else document.getElementById("decks-wrapper").classList.remove("locked");

        if(data.timer === 0 && data.timerRunning) alarm.play();

        if (!data.timerRunning && timerInterval) {
            clearInterval(timerInterval);
            timerInterval = null;
        }
    });

    function rollDice() {
        const ops = [{i:"üé®", t:"–†–∏—Å—É–≤–∞–π"}, {i:"üé≠", t:"–ü–æ–∫–∞–∂–∏"}, {i:"üó£", t:"–û–±—è—Å–Ω–∏"}];
        let c = 0;
        const iv = setInterval(() => {
            const p = ops[Math.floor(Math.random()*3)];
            document.getElementById("game-title").innerHTML = `<span class="dice-result">${p.i}</span> <span>${p.t}</span>`;
            if(c++ > 15) {
                clearInterval(iv);
                db.update({ title: document.getElementById("game-title").innerHTML, cardsLocked: false });
            }
        }, 70);
    }

    function selectDeck(lvl, el) {
        currentLevelPoints = lvl;
        isCardSelected = true;
        document.getElementById("t-btn").disabled = false; // –ê–∫—Ç–∏–≤–∏—Ä–∞–º–µ –±—É—Ç–æ–Ω–∞ –Ω–∞ —Ç–∞–π–º–µ—Ä–∞
        
        const card = cards[lvl][Math.floor(Math.random()*cards[lvl].length)];
        document.querySelectorAll(".deck-container").forEach(d => d !== el && d.classList.add("hidden"));
        el.classList.add("selected");
        el.querySelector(".deck").classList.add("flipped");
        el.querySelector(".deck-back").innerHTML = `<div class="card-content"><div>üé® ${card.draw}</div><div>üé≠ ${card.act}</div><div>üó£ ${card.speak}</div></div>`;
        
        document.getElementById("success-label").textContent = `‚úÖ –ü–û–ó–ù–ê–¢–û (+${lvl} —Ç.)`;
        document.getElementById("add-blue").textContent = `–°–ò–ù–ò (+${lvl})`;
        document.getElementById("add-red").textContent = `–ß–ï–†–í–ï–ù–ò (+${lvl})`;
        document.getElementById("success-area").style.display = "flex";
    }

    function startTimer() {
        if(!isCardSelected) return; // –ó–∞—â–∏—Ç–∞
        if(timerInterval) clearInterval(timerInterval);
        
        let t = 60;
        db.update({ timerRunning: true, timer: t });
        timerInterval = setInterval(() => {
            t--;
            if(t >= 0) db.update({ timer: t });
            else { clearInterval(timerInterval); db.update({ timerRunning: false }); }
        }, 1000);
    }

    // –°–ø–∏—Ä–∞ —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–µ –Ω–∞ "–ü–æ–∑–Ω–∞—Ç–æ"
    function stopTimerAndShowScore() {
        if(timerInterval) {
            clearInterval(timerInterval);
            timerInterval = null;
            db.update({ timerRunning: false });
        }
        document.getElementById("score-selection").style.display = "flex";
    }

    function addPoint(team) {
        db.child("scores").child(team).transaction(s => (s || 0) + currentLevelPoints);
        resetCloud(); // –î–∏—Ä–µ–∫—Ç–Ω–æ –Ω—É–ª–∏—Ä–∞ –∑–∞ —Å–ª–µ–¥–≤–∞—â —Ö–æ–¥
    }

    function resetScores() {
        if(confirm("–ù—É–ª–∏—Ä–∞–Ω–µ –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞?")) {
            db.child("scores").set({ blue: 0, red: 0 });
            resetCloud();
        }
    }

    function resetCloud() {
        if(timerInterval) clearInterval(timerInterval);
        timerInterval = null;
        isCardSelected = false;
        document.getElementById("t-btn").disabled = true; // –ó–∞–∫–ª—é—á–≤–∞–º–µ —Ç–∞–π–º–µ—Ä–∞ –æ–±—Ä–∞—Ç–Ω–æ
        
        db.update({ 
            title: "üéÆ My Activity", 
            timer: 60, 
            cardsLocked: true, 
            timerRunning: false 
        });

        document.getElementById("success-area").style.display = "none";
        document.getElementById("score-selection").style.display = "none";
        document.querySelectorAll(".deck-container").forEach(d => {
            d.classList.remove("hidden", "selected");
            d.querySelector(".deck").classList.remove("flipped");
        });
    }
</script>
</body>
</html>


