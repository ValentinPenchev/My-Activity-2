<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Activity Royale Real-Time</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    
    <style>
        :root {
            --primary: #ff512f;
            --secondary: #dd2476;
            --blue-team: #00d2ff;
            --red-team: #ff4b2b;
            --glass: rgba(255, 255, 255, 0.1);
        }
        body {
            margin: 0; padding: 10px; font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: white; min-height: 100vh; display: flex; flex-direction: column; align-items: center;
        }
        .scoreboard { display: flex; gap: 15px; margin-bottom: 15px; width: 100%; max-width: 600px; }
        .score-box { flex: 1; padding: 10px; border-radius: 15px; text-align: center; backdrop-filter: blur(10px); border: 2px solid rgba(255,255,255,0.1); }
        .blue { background: rgba(0, 210, 255, 0.2); border-color: var(--blue-team); }
        .red { background: rgba(255, 75, 43, 0.2); border-color: var(--red-team); }
        .score-number { font-size: 2.2rem; font-weight: bold; display: block; }
        .game-container { width: 95%; max-width: 650px; background: var(--glass); backdrop-filter: blur(15px); border-radius: 30px; padding: 20px; text-align: center; }
        h1 { font-size: 1.6rem; min-height: 65px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .dice-result { color: #00ffcc; font-size: 2.8rem; }
        .decks { display: flex; gap: 15px; justify-content: center; margin: 20px 0; min-height: 220px; }
        .decks.locked { opacity: 0.3; pointer-events: none; filter: grayscale(1); }
        .deck-container { width: 130px; height: 190px; perspective: 1000px; cursor: pointer; transition: 0.4s; }
        .deck-container.selected { width: 310px; height: 430px; z-index: 10; }
        .deck-container.hidden { width: 0; opacity: 0; margin: 0; pointer-events: none; }
        .deck { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: 0.7s; }
        .deck.flipped { transform: rotateY(180deg); }
        .deck-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 20px; overflow: hidden; border: 2px solid rgba(255,255,255,0.2); }
        .deck-face img { width: 100%; height: 100%; object-fit: cover; }
        .deck-back { transform: rotateY(180deg); background: white; color: #222; display: flex; align-items: center; justify-content: center; }
        .card-content { padding: 25px; font-weight: bold; font-size: 1.7rem; text-align: left; width: 100%; }
        .card-content div { border-bottom: 2px solid #f0f0f0; padding: 12px 0; }
        #success-area { display: none; margin: 15px 0; flex-direction: column; gap: 10px; }
        .btn-success { background: linear-gradient(45deg, #00b09b, #96c93d); padding: 18px; font-size: 1.4rem; border-radius: 15px; border: none; color: white; font-weight: bold; cursor: pointer; }
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        button { padding: 15px; border: none; border-radius: 15px; font-weight: bold; color: white; cursor: pointer; }
        .dice-btn { background: linear-gradient(45deg, var(--primary), var(--secondary)); }
        .timer-btn { background: linear-gradient(45deg, #f09819, #edde5d); color: #222; }
        .reset-btn { background: #333; grid-column: span 2; }
        .timer-display { font-size: 4.5rem; color: #00ffcc; font-family: monospace; font-weight: bold; }
    </style>
</head>
<body>

<div class="scoreboard">
    <div class="score-box blue"><span>–°–ò–ù–ò</span><span class="score-number" id="score-blue">0</span></div>
    <div class="score-box red"><span>–ß–ï–†–í–ï–ù–ò</span><span class="score-number" id="score-red">0</span></div>
</div>

<div class="game-container">
    <h1 id="game-title">üéÆ My Activity</h1>
    <div class="decks locked" id="decks-wrapper">
        <div class="deck-container" id="d3" onclick="selectDeck(3, this)"><div class="deck"><div class="deck-face"><img src="3 back.png"></div><div class="deck-face deck-back"></div></div></div>
        <div class="deck-container" id="d4" onclick="selectDeck(4, this)"><div class="deck"><div class="deck-face"><img src="4 back.png"></div><div class="deck-face deck-back"></div></div></div>
        <div class="deck-container" id="d5" onclick="selectDeck(5, this)"><div class="deck"><div class="deck-face"><img src="5 back.png"></div><div class="deck-face deck-back"></div></div></div>
    </div>
    <div id="success-area">
        <button id="success-label" class="btn-success" onclick="showScoreSelection()">‚úÖ –ü–û–ó–ù–ê–¢–û!</button>
        <div id="score-selection" style="display:none; gap:10px; margin-top:10px;">
            <button id="add-blue" style="background:var(--blue-team); flex:1" onclick="addPoint('blue')"></button>
            <button id="add-red" style="background:var(--red-team); flex:1" onclick="addPoint('red')"></button>
        </div>
    </div>
    <div class="controls">
        <button id="dice-btn" class="dice-btn" onclick="rollDice()">üé≤ –ó–ê–†–ß–ï</button>
        <button id="t-btn" class="timer-btn" onclick="startTimer()">‚è± 60 –°–ï–ö</button>
        <button class="reset-btn" onclick="resetCloud()">üîÑ –ù–û–í –•–û–î</button>
    </div>
    <div class="timer-display" id="timer">60</div>
</div>

<script>
    // --- –í–ê–®–ê–¢–ê –§–ò–ù–ê–õ–ù–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---
    const firebaseConfig = {
        apiKey: "AIzaSyC98brPgVFU1QIFpE9Q8N61xDiarrFERhM",
        authDomain: "my-activity-d2bc5.firebaseapp.com",
        databaseURL: "https://my-activity-d2bc5-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "my-activity-d2bc5",
        storageBucket: "my-activity-d2bc5.firebasestorage.app",
        messagingSenderId: "940491408918",
        appId: "1:940491408918:web:c7b521d5e36f7711bc5737",
        measurementId: "G-NN76LJX7ET"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database().ref("game_session_global");

    let currentLevelPoints = 0;
    const cards = {
        3: [{draw:"–ú–æ—Å—Ç", act:"–ö–æ–ª–µ–±–∞–µ—à —Å–µ", speak:"–û—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç"}, {draw:"–ü–ª–∞–Ω–∏–Ω–∞", act:"–†–µ—à–∞–≤–∞—à", speak:"–î–æ–≤–µ—Ä–∏–µ"}, {draw:"–ö–∞—Ä—Ç–∞", act:"–û–±—ä—Ä–∫–∞–Ω", speak:"–ü—Ä–æ–≤–∞–ª"}, {draw:"–ö–æ—Ä–∞–±", act:"–°—ä–º–Ω—è–≤–∞—à —Å–µ", speak:"–ù–∞–≤–∏–∫"}, {draw:"–ß–∞—Å–æ–≤–Ω–∏–∫", act:"–ü–∞–Ω–∏–∫–∞", speak:"–ù–∞—Ç–∏—Å–∫"}, {draw:"–õ–∞–±–∏—Ä–∏–Ω—Ç", act:"–¢—ä—Ä–ø–µ–ª–∏–≤", speak:"–ë–∞–ª–∞–Ω—Å"}, {draw:"–ü–ª–∞–∂", act:"–í–ª—é–±–µ–Ω", speak:"–ì—Ä–∞–Ω–∏—Ü–∞"}, {draw:"–°—è–Ω–∫–∞", act:"–Ø–¥–æ—Å–∞–Ω", speak:"–ü—Ä–∏–Ω—Ü–∏–ø"}, {draw:"–ö—É–ª–∞", act:"–°–ø–æ–∫–æ–µ–Ω", speak:"–ü–æ—Å–ª–µ–¥–∏—Ü–∞"}, {draw:"–ú–∞—Å–∫–∞", act:"–ü—Ä–µ—Å—Ç—Ä—É–≤–∞—à —Å–µ", speak:"–ò—Å—Ç–∏–Ω–∞"}, {draw:"–í—ä–ª–Ω–∞", act:"–û—á–∞–∫–≤–∞—à", speak:"–ò–∑–±–æ—Ä"}, {draw:"–í–µ–∑–Ω–∏", act:"–°—Ä–∞–≤–Ω—è–≤–∞—à", speak:"–ö–æ–º–ø—Ä–æ–º–∏—Å"}, {draw:"–ö—Ä—ä–≥", act:"–û—Ç–∫–∞–∑–≤–∞—à", speak:"–ü—Ä–∏—á–∏–Ω–∞"}, {draw:"–°—Ç—ä–ª–±–∞", act:"–û–ø–∏–≤–∞—Ç–∞—à", speak:"–†–µ–∑—É–ª—Ç–∞—Ç"}, {draw:"–ü—ä–∑–µ–ª", act:"–¢—ä—Ä–∂–µ—Å—Ç–≤—É–≤–∞—à", speak:"–ì–æ—Ä–¥–æ—Å—Ç"}, {draw:"–ö–ª–µ—Ç–∫–∞", act:"–ë—è–≥–∞—à", speak:"–°–≤–æ–±–æ–¥–∞"}, {draw:"–õ–∏–Ω–∏—è", act:"–°–ø–∏—Ä–∞—à", speak:"–ì—Ä–∞–Ω–∏—Ü–∞"}, {draw:"–§–ª–∞–≥", act:"–ó–∞—â–∏—Ç–∞–≤–∞—à", speak:"–ü–æ–∑–∏—Ü–∏—è"}, {draw:"–í—Ä–∞—Ç–∞", act:"–°—ä–º–Ω—è–≤–∞—à —Å–µ", speak:"–í—è—Ä–∞"}, {draw:"–û–≥—ä–Ω", act:"–†–∏—Å–∫—É–≤–∞—à", speak:"–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ"}, {draw:"–ü—ä—Ç", act:"–ò–∑–±–∏—Ä–∞—à", speak:"–ù–∞—Å–æ–∫–∞"}, {draw:"–†–∞–º–∫–∞", act:"–û–≥–ª–µ–∂–¥–∞—à", speak:"–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞"}, {draw:"–ö–ª—é—á", act:"–û—Ç–∫–∞–∑", speak:"–†–µ—à–µ–Ω–∏–µ"}, {draw:"–°—Ñ–µ—Ä–∞", act:"–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞—à", speak:"–ù–∞—Ç–∏—Å–∫"}, {draw:"–°—Ç–µ–Ω–∞", act:"–°–ø–∏—Ä–∞—à", speak:"–ü—Ä–µ—á–∫–∞"}, {draw:"–ú—Ä–µ–∂–∞", act:"–°–≤—ä—Ä–∑–≤–∞—à", speak:"–ö–æ–Ω—Ç–∞–∫—Ç"}, {draw:"–ü—è—Å—ä–∫", act:"–ò–∑–ø—É—Å–∫–∞—à", speak:"–í—Ä–µ–º–µ"}, {draw:"–ö–æ–º–ø–∞—Å", act:"–ù–∞—Å–æ—á–≤–∞—à", speak:"–ü–æ—Å–æ–∫–∞"}, {draw:"–õ—ä–∫", act:"–¶–µ–ª–∏—à", speak:"–ê–º–±–∏—Ü–∏—è"}, {draw:"–ö–ª—é—á–∞–ª–∫–∞", act:"–ü–∞–∑–∏—à", speak:"–¢–∞–π–Ω–∞"}, {draw:"–¢–æ–ø–∫–∞", act:"–ü–æ–¥—Ö–≤—ä—Ä–ª—è—à", speak:"–®–∞–Ω—Å"}, {draw:"–ü–ª–∞—Ç–Ω–æ", act:"–°—ä–∑–¥–∞–≤–∞—à", speak:"–ò–¥–µ—è"}, {draw:"–ö–≤–∞–¥—Ä–∞—Ç", act:"–ü–æ–¥—Ä–µ–∂–¥–∞—à", speak:"–†–µ–¥"}, {draw:"–ö–æ—Ä–∞", act:"–ó–∞—â–∏—Ç–∞–≤–∞—à", speak:"–°–∏–≥—É—Ä–Ω–æ—Å—Ç"}, {draw:"–°—Ç—Ä–µ–ª–∫–∞", act:"–ù–∞—Å–æ—á–≤–∞—à", speak:"–¶–µ–ª"}, {draw:"–°–∞–Ω–¥—ä–∫", act:"–û—Ç–∫—Ä–∏–≤–∞—à", speak:"–ò–∑–Ω–µ–Ω–∞–¥–∞"}, {draw:"–ü–∞—Ä–∞—à—É—Ç", act:"–ü–∞–¥–∞—à", speak:"–†–∏—Å–∫"}, {draw:"–ö–∞–º—ä–∫", act:"–£–ø–æ—Ä—Å—Ç–≤–∞—à", speak:"–ò–Ω–∞—Ç"}, {draw:"–ú–æ—Å—Ç", act:"–°–≤—ä—Ä–∑–≤–∞—à", speak:"–ö–æ–º–ø—Ä–æ–º–∏—Å"}, {draw:"–õ–∞–±–∏—Ä–∏–Ω—Ç", act:"–ì—É–±–∏—à —Å–µ", speak:"–¢—ä—Ä—Å–µ–Ω–µ"}],
        4: [{draw:"–•–∞–æ—Å", act:"–ò–º–ø—Ä–æ–≤–∏–∑–∏—Ä–∞—à", speak:"–°–º–∏—Å—ä–ª"}, {draw:"–ë–µ–∑–∫—Ä–∞–π–Ω–æ—Å—Ç", act:"–ì—É–±–∏—à –∫–æ–Ω—Ç—Ä–æ–ª", speak:"–°—ä—â–Ω–æ—Å—Ç"}, {draw:"–ë–∞–ª–∞–Ω—Å", act:"–ö–æ–ª–µ–±–∞–µ—à", speak:"–ò–∑–±–æ—Ä"}, {draw:"–ü–∞—Ä–∞–¥–æ–∫—Å", act:"–û—Ç—Ä–∏—á–∞—à", speak:"–ò—Å—Ç–∏–Ω–∞"}, {draw:"–ì—Ä–∞–Ω–∏—Ü–∞", act:"–û–≥—Ä–∞–Ω–∏—á–µ–Ω", speak:"–°–≤–æ–±–æ–¥–∞"}, {draw:"–¶–µ–Ω—Ç—ä—Ä", act:"–§–æ–∫—É—Å–∏—Ä–∞—à", speak:"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç"}, {draw:"–û—Ç—Ä–∞–∂–µ–Ω–∏–µ", act:"–ò–º–∏—Ç–∏—Ä–∞—à", speak:"–ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç"}, {draw:"–†–∞–∑–ª–æ–º", act:"–†–∞–∑–¥–µ–ª—è—à", speak:"–ö–æ–Ω—Ñ–ª–∏–∫—Ç"}, {draw:"–ü—ä—Ç", act:"–õ—É—Ç–∞–Ω–µ", speak:"–ü–æ—Å–æ–∫–∞"}, {draw:"–°–ø–∏—Ä–∞–ª–∞", act:"–ü–æ–≤—Ç–∞—Ä—è—à", speak:"–¶–∏–∫—ä–ª"}, {draw:"–¢–µ–∂–µ—Å—Ç", act:"–ù–∞—Ç–∏—Å–∫", speak:"–û—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç"}, {draw:"–ú—ä–≥–ª–∞", act:"–ù–µ—Å–∏–≥—É—Ä–Ω–æ—Å—Ç", speak:"–°—ä–º–Ω–µ–Ω–∏–µ"}, {draw:"–í—Ä—ä—Ö", act:"–¢—Ä–∏—É–º—Ñ", speak:"–£—Å–ø–µ—Ö"}, {draw:"–ü—Ä–∞–∑–Ω–æ—Ç–∞", act:"–ó–∞–º—Ä—ä–∑–≤–∞—à", speak:"–õ–∏–ø—Å–∞"}, {draw:"–ò—Å–∫—Ä–∞", act:"–í—ä–∑–ø–ª–∞–º–µ–Ω—è–≤–∞—à", speak:"–í–¥—ä—Ö–Ω–æ–≤–µ–Ω–∏–µ"}, {draw:"–ü—É–∫–Ω–∞—Ç–∏–Ω–∞", act:"–ü—Ä–µ—á—É–ø–≤–∞—à", speak:"–ö—Ä–∞—Ö"}, {draw:"–¢–æ—á–∫–∞", act:"–°–ø–∏—Ä–∞—à", speak:"–ö—Ä–∞–π"}, {draw:"–í—ä–ª–Ω–∞", act:"–ó–∞–≤–ª–∏—á–∞—à", speak:"–í–ª–∏—è–Ω–∏–µ"}, {draw:"–û–≥—ä–Ω", act:"–£–Ω–∏—â–æ–∂–∞–≤–∞—à", speak:"–ü—Ä–æ–º—è–Ω–∞"}, {draw:"–°—è–Ω–∫–∞", act:"–ö—Ä–∏–µ—à", speak:"–°—Ç—Ä–∞—Ö"}, {draw:"–õ–∞–±–∏—Ä–∏–Ω—Ç", act:"–ë–ª—É–∂–¥–∞–µ—à", speak:"–¢—ä—Ä—Å–µ–Ω–µ"}, {draw:"–ú–æ—Å—Ç", act:"–°–≤—ä—Ä–∑–≤–∞—à", speak:"–î–∏–∞–ª–æ–≥"}, {draw:"–ö—Ä—ä–≥", act:"–ü–æ–≤—Ç–∞—Ä—è—à", speak:"–ù–∞–≤–∏–∫"}, {draw:"–°—Ç–µ–Ω–∞", act:"–û—Ç–±–ª—ä—Å–∫–≤–∞—à", speak:"–ì—Ä–∞–Ω–∏—Ü–∞"}, {draw:"–ö–ª—é—á", act:"–û—Ç–∫–ª—é—á–≤–∞—à", speak:"–†–µ—à–µ–Ω–∏–µ"}, {draw:"–ü—Ä–æ–ø–∞—Å—Ç", act:"–ö–æ–ª–µ–±–∞–Ω–∏–µ", speak:"–†–∏—Å–∫"}, {draw:"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞", act:"–ò–∑–¥–∏–≥–∞—à", speak:"–í—ä–∑–º–æ–∂–Ω–æ—Å—Ç"}, {draw:"–ü—ä—Ç–µ–≤–æ–¥–∏—Ç–µ–ª", act:"–ù–∞—Å–æ—á–≤–∞—à", speak:"–°–º–∏—Å—ä–ª"}, {draw:"–†–∞–º–∫–∞", act:"–û–≥—Ä–∞–Ω–∏—á–∞–≤–∞—à", speak:"–ö–æ–Ω—Ç–µ–∫—Å—Ç"}, {draw:"–¢–µ–∂–µ—Å—Ç", act:"–ü—Ä–∏—Ç–∏—Å–∫–∞—à", speak:"–ù–∞—Ç–∏—Å–∫"}, {draw:"–ó–Ω–∞–∫", act:"–ü–æ–∫–∞–∑–≤–∞—à", speak:"–ó–Ω–∞—á–µ–Ω–∏–µ"}, {draw:"–ü—Ä–∞–≥", act:"–ü—Ä–µ–∫—Ä–∞—á–≤–∞—à", speak:"–ù–∞—á–∞–ª–æ"}, {draw:"–í–µ—Ä–∏–≥–∞", act:"–ó–∞–¥—ä—Ä–∂–∞—à", speak:"–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç"}, {draw:"–ú–∞—Å–∫–∞", act:"–ü—Ä–µ—Å—Ç—Ä—É–≤–∞—à", speak:"–õ—ä–∂–∞"}, {draw:"–†–∏—Ç—ä–º", act:"–ü–æ–≤—Ç–∞—Ä—è—à", speak:"–ü—Ä–æ—Ü–µ—Å"}, {draw:"–¢–æ—á–∫–∞", act:"–†–µ—à–∏—Ç–µ–ª–Ω–æ—Å—Ç", speak:"–§–∏–Ω–∞–ª"}, {draw:"–ü–ª–∞–º—ä–∫", act:"–ò–º–ø—É–ª—Å", speak:"–ñ–µ–ª–∞–Ω–∏–µ"}, {draw:"–ö–æ—Ä–µ–Ω", act:"–ó–∞–∑–µ–º—è–≤–∞—à", speak:"–ü—Ä–æ–∏–∑—Ö–æ–¥"}, {draw:"–ö–æ–Ω—Ç—É—Ä", act:"–û—á–µ—Ä—Ç–∞–≤–∞—à", speak:"–ì—Ä–∞–Ω–∏—Ü–∞"}, {draw:"–í—ä–∑–µ–ª", act:"–ó–∞–ø–ª–∏—Ç–∞—à", speak:"–ü—Ä–æ–±–ª–µ–º"}],
        5: [{draw:"–í—É–ª–∫–∞–Ω", act:"–ï–∫—Å–ø–ª–æ–∑–∏–≤–µ–Ω", speak:"–ï–Ω–µ—Ä–≥–∏—è"}, {draw:"–ö–æ—Å–º–æ—Å", act:"–ë–µ–∑—Ç–µ–≥–ª–æ–≤–Ω–æ—Å—Ç", speak:"–ú–∏—Å–∏—è"}, {draw:"–ü—è—Å—ä–∫", act:"–ò–∑–ø—É—Å–∫–∞—à", speak:"–í—Ä–µ–º–µ"}, {draw:"–ö–æ–º–ø–∞—Å", act:"–ù–∞—Å–æ—á–≤–∞—à", speak:"–ü–æ—Å–æ–∫–∞"}, {draw:"–ó–≤–µ–∑–¥–∞", act:"–ë–ª–µ—Å—Ç–∏—à", speak:"–ú–µ—á—Ç–∞"}, {draw:"–ë–µ–∑–¥–Ω–∞", act:"–ü—Ä–æ–ø–∞–¥–∞—à", speak:"–ú–∏–Ω–∞–ª–æ"}]
    };

    const alarm = new Audio("https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg");

    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø—Ä–æ–º—è–Ω–∞ –≤ –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏
    db.on("value", (snap) => {
        const data = snap.val();
        if(!data) {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–∫–æ –±–∞–∑–∞—Ç–∞ –µ –ø—Ä–∞–∑–Ω–∞
            db.set({ scores: { blue: 0, red: 0 }, timer: 60, title: "üéÆ My Activity", cardsLocked: true, timerRunning: false });
            return;
        }
        document.getElementById("score-blue").textContent = data.scores.blue;
        document.getElementById("score-red").textContent = data.scores.red;
        document.getElementById("timer").textContent = data.timer;
        document.getElementById("game-title").innerHTML = data.title;
        
        if(data.cardsLocked) document.getElementById("decks-wrapper").classList.add("locked");
        else document.getElementById("decks-wrapper").classList.remove("locked");

        if(data.timer === 0 && data.timerRunning) {
            alarm.play();
            db.update({ timerRunning: false });
        }
    });

    function rollDice() {
        const ops = [{i:"üé®", t:"–†–∏—Å—É–≤–∞–π"}, {i:"üé≠", t:"–ü–æ–∫–∞–∂–∏"}, {i:"üó£", t:"–û–±—è—Å–Ω–∏"}];
        let c = 0;
        const iv = setInterval(() => {
            const p = ops[Math.floor(Math.random()*3)];
            const html = `<span class="dice-result">${p.i}</span> <span class="dice-text">${p.t}</span>`;
            document.getElementById("game-title").innerHTML = html;
            if(c++ > 15) {
                clearInterval(iv);
                db.update({ title: html, cardsLocked: false });
            }
        }, 70);
    }

    function selectDeck(lvl, el) {
        currentLevelPoints = lvl;
        const card = cards[lvl].shift(); 
        cards[lvl].push(card);
        
        document.querySelectorAll(".deck-container").forEach(d => d !== el && d.classList.add("hidden"));
        el.classList.add("selected");
        el.querySelector(".deck").classList.add("flipped");
        el.querySelector(".deck-back").innerHTML = `<div class="card-content"><div>üé® ${card.draw}</div><div>üé≠ ${card.act}</div><div>üó£ ${card.speak}</div></div>`;
        
        document.getElementById("success-label").textContent = `‚úÖ –ü–û–ó–ù–ê–¢–û (+${lvl} —Ç.)`;
        document.getElementById("add-blue").textContent = `–°–ò–ù–ò (+${lvl})`;
        document.getElementById("add-red").textContent = `–ß–ï–†–í–ï–ù–ò (+${lvl})`;
        document.getElementById("success-area").style.display = "flex";
    }

    function startTimer() {
        let t = 60;
        db.update({ timerRunning: true });
        const iv = setInterval(() => {
            t--;
            db.update({ timer: t });
            if(t <= 0) clearInterval(iv);
        }, 1000);
    }

    function showScoreSelection() { document.getElementById("score-selection").style.display = "flex"; }

    function addPoint(team) {
        db.child("scores").child(team).transaction(s => (s || 0) + currentLevelPoints);
        resetCloud();
    }

    function resetCloud() {
        db.update({ title: "üéÆ My Activity", timer: 60, cardsLocked: true, timerRunning: false });
        // –ú–∞–ª—ä–∫ —Ä–µ—Å–µ—Ç –Ω–∞ –ª–æ–∫–∞–ª–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        document.getElementById("success-area").style.display = "none";
        document.getElementById("score-selection").style.display = "none";
        document.querySelectorAll(".deck-container").forEach(d => {
            d.classList.remove("hidden", "selected");
            d.querySelector(".deck").classList.remove("flipped");
        });
    }
</script>
</body>
</html>