<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Activity Royale Pro</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    
    <style>
        :root {
            --primary: #ff512f;
            --secondary: #dd2476;
            --glass: rgba(255, 255, 255, 0.1);
            --accent: #00ffcc;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 10px; font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: white; min-height: 100vh; display: flex; flex-direction: column; align-items: center;
            overflow-x: hidden;
        }

        /* –ú–ï–ù–Æ */
        .settings-btn { position: absolute; top: 15px; right: 15px; background: var(--glass); border: 1px solid rgba(255,255,255,0.2); padding: 12px; border-radius: 50%; cursor: pointer; z-index: 100; font-size: 1.2rem; line-height: 1; }
        .side-menu { position: fixed; top: 0; right: -300px; width: 280px; height: 100%; background: #1e1e32; box-shadow: -5px 0 20px rgba(0,0,0,0.5); transition: 0.3s ease; z-index: 1000; padding: 25px; }
        .side-menu.active { right: 0; }
        .menu-close { background: none; border: none; color: white; font-size: 1.5rem; float: right; cursor: pointer; }
        
        /* –¢–ê–ë–õ–û */
        .scoreboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px; width: 100%; max-width: 600px; margin-bottom: 15px; margin-top: 50px; }
        .score-box { padding: 10px; border-radius: 15px; text-align: center; backdrop-filter: blur(10px); border: 2px solid rgba(255,255,255,0.1); position: relative; }
        .score-number { font-size: 1.8rem; font-weight: bold; display: block; color: var(--accent); }
        .btn-del { position: absolute; top: 2px; right: 5px; color: rgba(255,255,255,0.3); border: none; background: none; font-size: 0.8rem; cursor: pointer; }

        /* –ò–ì–†–ê */
        .game-container { width: 95%; max-width: 650px; background: var(--glass); backdrop-filter: blur(15px); border-radius: 30px; padding: 20px; text-align: center; }
        h1 { font-size: 1.5rem; min-height: 60px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        
        .decks { display: flex; gap: 10px; justify-content: center; margin: 15px 0; min-height: 200px; }
        .decks.locked { pointer-events: none; }
        
        .deck-container { width: 100px; height: 150px; perspective: 1000px; cursor: pointer; transition: 0.4s; }
        .deck-container.selected { width: 310px; height: 430px; z-index: 100; cursor: default; }
        .deck-container.hidden { width: 0; opacity: 0; margin: 0; pointer-events: none; }
        
        .deck { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: 0.6s; }
        .deck.flipped { transform: rotateY(180deg); }
        .deck-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 15px; overflow: hidden; border: 2px solid rgba(255,255,255,0.2); }
        .deck-face img { width: 100%; height: 100%; object-fit: cover; }
        
        .deck-back { 
            transform: rotateY(180deg); 
            background: #ffffff !important; 
            color: #1a1a1a !important; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            border-radius: 15px; 
            box-shadow: 0 15px 50px rgba(0,0,0,0.8); 
            border: 2px solid #ffffff;
        }
        .card-content { padding: 15px; width: 100%; }
        .card-row { 
            display: grid; 
            grid-template-columns: 40px 1fr; 
            align-items: center; 
            gap: 15px; 
            padding: 18px 10px;
            border-bottom: 1px solid #eee;
            text-align: left;
        }
        .card-row:last-child { border: none; }
        .card-row span:first-child { font-size: 1.8rem; }
        .card-row span:last-child { font-weight: 800; font-size: 1.4rem; line-height: 1.2; word-break: break-word; }

        /* –°–ï–ö–¶–ò–Ø –ü–û–ó–ù–ê–¢–û / –¢–û–ß–ö–ò */
        #success-area { display: none; margin: 15px 0; flex-direction: column; gap: 10px; }
        .btn-success { background: linear-gradient(45deg, #00b09b, #96c93d); padding: 18px; font-size: 1.2rem; border-radius: 15px; border: none; color: white; font-weight: bold; cursor: pointer; }
        
        .score-selection-grid { display: none; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .team-point-btn { padding: 14px; border-radius: 12px; border: none; color: white; font-weight: bold; cursor: pointer; font-size: 1rem; }

        /* –ö–û–ù–¢–†–û–õ–ò */
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .dice-btn { background: linear-gradient(45deg, var(--primary), var(--secondary)); padding: 15px; border-radius: 15px; font-weight: bold; color: white; border: none; cursor: pointer; }
        .timer-btn { background: #f09819; color: #222; padding: 15px; border-radius: 15px; font-weight: bold; border: none; cursor: pointer; }
        .timer-btn:disabled { background: #555; color: #888; cursor: not-allowed; opacity: 0.6; }

        .reset-btn { background: #333; grid-column: span 2; padding: 12px; border-radius: 15px; margin-top: 10px; color: white; border: none; font-weight: bold; cursor: pointer; }
        .timer-display { font-size: 4rem; color: var(--accent); font-family: monospace; font-weight: bold; margin-top: 5px; }
        .loading-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; justify-content: center; align-items: center; font-size: 1.5rem; }
    </style>
</head>
<body>

<div class="loading-overlay" id="loading">–ó–∞–ø–∏—Å–≤–∞–Ω–µ...</div>
<button class="settings-btn" onclick="toggleMenu()">‚öôÔ∏è</button>

<div class="side-menu" id="side-menu">
    <button class="menu-close" onclick="toggleMenu()">‚úï</button>
    <h3 style="margin-top: 20px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
    <a href="index.html" style="text-decoration: none;">
    <button style="width:100%; background: linear-gradient(45deg, #00d2ff, #3a7bd5); color:white; padding:15px; border:none; font-weight:800; border-radius:12px; cursor:pointer; display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,210,255,0.3); text-transform: uppercase; font-size: 0.9rem;">
        üè† –ì–õ–ê–í–ù–û –ú–ï–ù–Æ
    </button>
</a>

<div style="height: 1px; background: rgba(255,255,255,0.1); margin-bottom: 20px;"></div>
    <input type="text" id="team-name-input" placeholder="–ò–º–µ –Ω–∞ –æ—Ç–±–æ—Ä" style="width:100%; padding:10px; margin-bottom:10px; border-radius:5px; border:none;">
    <button onclick="createNewTeam()" style="width:100%; background:var(--accent); color:black; padding:10px; border:none; font-weight:bold; border-radius:5px;">–î–æ–±–∞–≤–∏ –æ—Ç–±–æ—Ä +</button>
    <button onclick="resetGlobalScores()" style="width:100%; background:#ff4b2b; color:white; padding:10px; border:none; font-weight:bold; margin-top:40px; border-radius:5px;">–ù–£–õ–ò–†–ê–ô –†–ï–ó–£–õ–¢–ê–¢–ê</button>
</div>

<div class="scoreboard" id="scoreboard-ui"></div>

<div class="game-container">
    <h1 id="game-title">üéÆ My Activity</h1>
    
    <div class="decks locked" id="decks-wrapper">
        <div class="deck-container" id="d3" onclick="selectDeck(3, this)"><div class="deck"><div class="deck-face"><img src="3 back.png"></div><div class="deck-face deck-back"></div></div></div>
        <div class="deck-container" id="d4" onclick="selectDeck(4, this)"><div class="deck"><div class="deck-face"><img src="4 back.png"></div><div class="deck-face deck-back"></div></div></div>
        <div class="deck-container" id="d5" onclick="selectDeck(5, this)"><div class="deck"><div class="deck-face"><img src="5 back.png"></div><div class="deck-face deck-back"></div></div></div>
    </div>

    <div id="success-area">
        <button id="success-label" class="btn-success" onclick="stopTimerAndShowScores()">‚úÖ –ü–û–ó–ù–ê–¢–û!</button>
        <div id="score-selection" class="score-selection-grid"></div>
    </div>

    <div class="controls">
        <button class="dice-btn" onclick="rollDice()">üé≤ –ó–ê–†–ß–ï</button>
        <button id="t-btn" class="timer-btn" onclick="startTimer()" disabled>‚è± –°–¢–ê–†–¢</button>
        <button class="reset-btn" onclick="resetCloud()">üîÑ –ù–û–í –•–û–î</button>
    </div>
    <div class="timer-display" id="timer">60</div>
</div>

<script>
    const cards = {
        3: [{d:"–ú–æ—Å—Ç", a:"–ö–æ–ª–µ–±–∞–µ—à —Å–µ", s:"–û—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç"},
        {d:"–ü–ª–∞–Ω–∏–Ω–∞", a:"–†–µ—à–∞–≤–∞—à", s:"–î–æ–≤–µ—Ä–∏–µ"},
        {d:"–ö–∞—Ä—Ç–∞", a:"–û–±—ä—Ä–∫–∞–Ω", s:"–ü—Ä–æ–≤–∞–ª"},
        {d:"–ö–æ—Ä–∞–±", a:"–°—ä–º–Ω—è–≤–∞—à —Å–µ", s:"–ù–∞–≤–∏–∫"},
        {d:"–ß–∞—Å–æ–≤–Ω–∏–∫", a:"–ü–∞–Ω–∏–∫–∞", s:"–ù–∞—Ç–∏—Å–∫"},
        {d:"–õ–∞–±–∏—Ä–∏–Ω—Ç", a:"–¢—ä—Ä–ø–µ–ª–∏–≤", s:"–ë–∞–ª–∞–Ω—Å"},
        {d:"–ü–ª–∞–∂", a:"–í–ª—é–±–µ–Ω", s:"–ì—Ä–∞–Ω–∏—Ü–∞"},
        {d:"–°—è–Ω–∫–∞", a:"–Ø–¥–æ—Å–∞–Ω", s:"–ü—Ä–∏–Ω—Ü–∏–ø"},
        {d:"–ö—É–ª–∞", a:"–°–ø–æ–∫–æ–µ–Ω", s:"–ü–æ—Å–ª–µ–¥–∏—Ü–∞"},
        {d:"–ú–∞—Å–∫–∞", a:"–ü—Ä–µ—Å—Ç—Ä—É–≤–∞—à —Å–µ", s:"–ò—Å—Ç–∏–Ω–∞"},
        {d:"–í—ä–ª–Ω–∞", a:"–û—á–∞–∫–≤–∞—à", s:"–ò–∑–±–æ—Ä"},
        {d:"–í–µ–∑–Ω–∏", a:"–°—Ä–∞–≤–Ω—è–≤–∞—à", s:"–ö–æ–º–ø—Ä–æ–º–∏—Å"},
        {d:"–ö—Ä—ä–≥", a:"–û—Ç–∫–∞–∑–≤–∞—à", s:"–ü—Ä–∏—á–∏–Ω–∞"},
        {d:"–°—Ç—ä–ª–±–∞", a:"–û–ø–∏—Ç–≤–∞—à", s:"–†–µ–∑—É–ª—Ç–∞—Ç"},
        {d:"–ü—ä–∑–µ–ª", a:"–¢—ä—Ä–∂–µ—Å—Ç–≤—É–≤–∞—à", s:"–ì–æ—Ä–¥–æ—Å—Ç"},
        {d:"–ö–ª–µ—Ç–∫–∞", a:"–ë—è–≥–∞—à", s:"–°–≤–æ–±–æ–¥–∞"},
        {d:"–õ–∏–Ω–∏—è", a:"–°–ø–∏—Ä–∞—à", s:"–ì—Ä–∞–Ω–∏—Ü–∞"},
        {d:"–§–ª–∞–≥", a:"–ó–∞—â–∏—Ç–∞–≤–∞—à", s:"–ü–æ–∑–∏—Ü–∏—è"},
        {d:"–í—Ä–∞—Ç–∞", a:"–°—ä–º–Ω—è–≤–∞—à —Å–µ", s:"–í—è—Ä–∞"},
        {d:"–û–≥—ä–Ω", a:"–†–∏—Å–∫—É–≤–∞—à", s:"–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ"},
        {d:"–ü—ä—Ç", a:"–ò–∑–±–∏—Ä–∞—à", s:"–ù–∞—Å–æ–∫–∞"},
        {d:"–†–∞–º–∫–∞", a:"–û–≥–ª–µ–∂–¥–∞—à", s:"–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞"},
        {d:"–ö–ª—é—á", a:"–û—Ç–∫–∞–∑", s:"–†–µ—à–µ–Ω–∏–µ"},
        {d:"–°—Ñ–µ—Ä–∞", a:"–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞—à", s:"–ù–∞—Ç–∏—Å–∫"},
        {d:"–°—Ç–µ–Ω–∞", a:"–°–ø–∏—Ä–∞—à", s:"–ü—Ä–µ—á–∫–∞"},
        {d:"–ú—Ä–µ–∂–∞", a:"–°–≤—ä—Ä–∑–≤–∞—à", s:"–ö–æ–Ω—Ç–∞–∫—Ç"},
        {d:"–ü—è—Å—ä–∫", a:"–ò–∑–ø—É—Å–∫–∞—à", s:"–í—Ä–µ–º–µ"},
        {d:"–ö–æ–º–ø–∞—Å", a:"–ù–∞—Å–æ—á–≤–∞—à", s:"–ü–æ—Å–æ–∫–∞"},
        {d:"–õ—ä–∫", a:"–¶–µ–ª–∏—à", s:"–ê–º–±–∏—Ü–∏—è"},
        {d:"–ö–ª—é—á–∞–ª–∫–∞", a:"–ü–∞–∑–∏—à", s:"–¢–∞–π–Ω–∞"},
        {d:"–¢–æ–ø–∫–∞", a:"–ü–æ–¥—Ö–≤—ä—Ä–ª—è—à", s:"–®–∞–Ω—Å"},
        {d:"–ü–ª–∞—Ç–Ω–æ", a:"–°—ä–∑–¥–∞–≤–∞—à", s:"–ò–¥–µ—è"},
        {d:"–ö–≤–∞–¥—Ä–∞—Ç", a:"–ü–æ–¥—Ä–µ–∂–¥–∞—à", s:"–†–µ–¥"},
        {d:"–ö–æ—Ä–∞", a:"–ó–∞—â–∏—Ç–∞–≤–∞—à", s:"–°–∏–≥—É—Ä–Ω–æ—Å—Ç"},
        {d:"–°—Ç—Ä–µ–ª–∫–∞", a:"–ù–∞—Å–æ—á–≤–∞—à", s:"–¶–µ–ª"},
        {d:"–°–∞–Ω–¥—ä–∫", a:"–û—Ç–∫—Ä–∏–≤–∞—à", s:"–ò–∑–Ω–µ–Ω–∞–¥–∞"},
        {d:"–ü–∞—Ä–∞—à—É—Ç", a:"–ü–∞–¥–∞—à", s:"–†–∏—Å–∫"},
        {d:"–ö–∞–º—ä–∫", a:"–£–ø–æ—Ä—Å—Ç–≤–∞—à", s:"–ò–Ω–∞—Ç"},
        {d:"–ú–æ—Å—Ç", a:"–°–≤—ä—Ä–∑–≤–∞—à", s:"–ö–æ–º–ø—Ä–æ–º–∏—Å"},
        {d:"–õ–∞–±–∏—Ä–∏–Ω—Ç", a:"–ì—É–±–∏—à —Å–µ", s:"–¢—ä—Ä—Å–µ–Ω–µ"}],
        //–¢–µ—Å—Ç–µ 4
        4: [{d:"–•–∞–æ—Å", a:"–ò–º–ø—Ä–æ–≤–∏–∑–∏—Ä–∞—à", s:"–°–º–∏—Å—ä–ª"},
        {d:"–ë–µ–∑–∫—Ä–∞–π–Ω–æ—Å—Ç", a:"–ì—É–±–∏—à –∫–æ–Ω—Ç—Ä–æ–ª", s:"–°—ä—â–Ω–æ—Å—Ç"},
        {d:"–ë–∞–ª–∞–Ω—Å", a:"–ö–æ–ª–µ–±–∞–µ—à", s:"–ò–∑–±–æ—Ä"},
        {d:"–ü–∞—Ä–∞–¥–æ–∫—Å", a:"–û—Ç—Ä–∏—á–∞—à", s:"–ò—Å—Ç–∏–Ω–∞"},
        {d:"–ì—Ä–∞–Ω–∏—Ü–∞", a:"–û–≥—Ä–∞–Ω–∏—á–µ–Ω", s:"–°–≤–æ–±–æ–¥–∞"},
        {d:"–¶–µ–Ω—Ç—ä—Ä", a:"–§–æ–∫—É—Å–∏—Ä–∞—à", s:"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç"},
        {d:"–û—Ç—Ä–∞–∂–µ–Ω–∏–µ", a:"–ò–º–∏—Ç–∏—Ä–∞—à", s:"–ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç"},
        {d:"–†–∞–∑–ª–æ–º", a:"–†–∞–∑–¥–µ–ª—è—à", s:"–ö–æ–Ω—Ñ–ª–∏–∫—Ç"},
        {d:"–ü—ä—Ç", a:"–õ—É—Ç–∞–Ω–µ", s:"–ü–æ—Å–æ–∫–∞"},
        {d:"–°–ø–∏—Ä–∞–ª–∞", a:"–ü–æ–≤—Ç–∞—Ä—è—à", s:"–¶–∏–∫—ä–ª"},
        {d:"–¢–µ–∂–µ—Å—Ç", a:"–ù–∞—Ç–∏—Å–∫", s:"–û—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç"},
        {d:"–ú—ä–≥–ª–∞", a:"–ù–µ—Å–∏–≥—É—Ä–Ω–æ—Å—Ç", s:"–°—ä–º–Ω–µ–Ω–∏–µ"},
        {d:"–í—Ä—ä—Ö", a:"–¢—Ä–∏—É–º—Ñ", s:"–£—Å–ø–µ—Ö"},
        {d:"–ü—Ä–∞–∑–Ω–æ—Ç–∞", a:"–ó–∞–º—Ä—ä–∑–≤–∞—à", s:"–õ–∏–ø—Å–∞"},
        {d:"–ò—Å–∫—Ä–∞", a:"–í—ä–∑–ø–ª–∞–º–µ–Ω—è–≤–∞—à", s:"–í–¥—ä—Ö–Ω–æ–≤–µ–Ω–∏–µ"},
        {d:"–ü—É–∫–Ω–∞—Ç–∏–Ω–∞", a:"–ü—Ä–µ—á—É–ø–≤–∞—à", s:"–ö—Ä–∞—Ö"},
        {d:"–¢–æ—á–∫–∞", a:"–°–ø–∏—Ä–∞—à", s:"–ö—Ä–∞–π"},
        {d:"–í—ä–ª–Ω–∞", a:"–ó–∞–≤–ª–∏—á–∞—à", s:"–í–ª–∏—è–Ω–∏–µ"},
        {d:"–û–≥—ä–Ω", a:"–£–Ω–∏—â–æ–∂–∞–≤–∞—à", s:"–ü—Ä–æ–º—è–Ω–∞"},
        {d:"–°—è–Ω–∫–∞", a:"–ö—Ä–∏–µ—à", s:"–°—Ç—Ä–∞—Ö"},
        {d:"–õ–∞–±–∏—Ä–∏–Ω—Ç", a:"–ë–ª—É–∂–¥–∞–µ—à", s:"–¢—ä—Ä—Å–µ–Ω–µ"},
        {d:"–ú–æ—Å—Ç", a:"–°–≤—ä—Ä–∑–≤–∞—à", s:"–î–∏–∞–ª–æ–≥"},
        {d:"–ö—Ä—ä–≥", a:"–ü–æ–≤—Ç–∞—Ä—è—à", s:"–ù–∞–≤–∏–∫"},
        {d:"–°—Ç–µ–Ω–∞", a:"–û—Ç–±–ª—ä—Å–∫–≤–∞—à", s:"–ì—Ä–∞–Ω–∏—Ü–∞"},
        {d:"–ö–ª—é—á", a:"–û—Ç–∫–ª—é—á–≤–∞—à", s:"–†–µ—à–µ–Ω–∏–µ"},
        {d:"–ü—Ä–æ–ø–∞—Å—Ç", a:"–ö–æ–ª–µ–±–∞–Ω–∏–µ", s:"–†–∏—Å–∫"},
        {d:"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞", a:"–ò–∑–¥–∏–≥–∞—à", s:"–í—ä–∑–º–æ–∂–Ω–æ—Å—Ç"},
        {d:"–ü—ä—Ç–µ–≤–æ–¥–∏—Ç–µ–ª", a:"–ù–∞—Å–æ—á–≤–∞—à", s:"–°–º–∏—Å—ä–ª"},
        {d:"–†–∞–º–∫–∞", a:"–û–≥—Ä–∞–Ω–∏—á–∞–≤–∞—à", s:"–ö–æ–Ω—Ç–µ–∫—Å—Ç"},
        {d:"–¢–µ–∂–µ—Å—Ç", a:"–ü—Ä–∏—Ç–∏—Å–∫–∞—à", s:"–ù–∞—Ç–∏—Å–∫"},
        {d:"–ó–Ω–∞–∫", a:"–ü–æ–∫–∞–∑–≤–∞—à", s:"–ó–Ω–∞—á–µ–Ω–∏–µ"},
        {d:"–ü—Ä–∞–≥", a:"–ü—Ä–µ–∫—Ä–∞—á–≤–∞—à", s:"–ù–∞—á–∞–ª–æ"},
        {d:"–í–µ—Ä–∏–≥–∞", a:"–ó–∞–¥—ä—Ä–∂–∞—à", s:"–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç"},
        {d:"–ú–∞—Å–∫–∞", a:"–ü—Ä–µ—Å—Ç—Ä—É–≤–∞—à", s:"–õ—ä–∂–∞"},
        {d:"–†–∏—Ç—ä–º", a:"–ü–æ–≤—Ç–∞—Ä—è—à", s:"–ü—Ä–æ—Ü–µ—Å"},
        {d:"–¢–æ—á–∫–∞", a:"–†–µ—à–∏—Ç–µ–ª–Ω–æ—Å—Ç", s:"–§–∏–Ω–∞–ª"},
        {d:"–ü–ª–∞–º—ä–∫", a:"–ò–º–ø—É–ª—Å", s:"–ñ–µ–ª–∞–Ω–∏–µ"},
        {d:"–ö–æ—Ä–µ–Ω", a:"–ó–∞–∑–µ–º—è–≤–∞—à", s:"–ü—Ä–æ–∏–∑—Ö–æ–¥"},
        {d:"–ö–æ–Ω—Ç—É—Ä", a:"–û—á–µ—Ä—Ç–∞–≤–∞—à", s:"–ì—Ä–∞–Ω–∏—Ü–∞"},
        {d:"–í—ä–∑–µ–ª", a:"–ó–∞–ø–ª–∏—Ç–∞—à", s:"–ü—Ä–æ–±–ª–µ–º"}],
        //–¢–µ—Å—Ç–µ 5
        5: [{d:"–°–∏–Ω–≥—É–ª—è—Ä–Ω–æ—Å—Ç", a:"–°–≤–∏–≤–∞—à —Å–µ", s:"–ë–µ–∑–∫—Ä–∞–π–Ω–æ—Å—Ç"},
        {d:"–ï–Ω—Ç—Ä–æ–ø–∏—è", a:"–†–∞–∑–ø–∞–¥–∞—à —Å–µ", s:"–•–∞–æ—Å"},
        {d:"–ü–æ–¥—Å—ä–∑–Ω–∞–Ω–∏–µ", a:"–ü—Ä–æ–ø–∞–¥–∞—à", s:"–°–∫—Ä–∏—Ç"},
        {d:"–ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è", a:"–î–µ—Ñ–æ—Ä–º–∏—Ä–∞—à", s:"–ò–¥–µ—è"},
        {d:"–í–∞–∫—É—É–º", a:"–ó–∞–¥—É—à–∞–≤–∞—à —Å–µ", s:"–ü—Ä–∞–∑–Ω–æ—Ç–∞"},
        {d:"–ê–ª–≥–æ—Ä–∏—Ç—ä–º", a:"–ú–µ—Ö–∞–Ω–∏—á–µ–Ω —Å–∏", s:"–õ–æ–≥–∏–∫–∞"},
        {d:"–ï–≤–æ–ª—é—Ü–∏—è", a:"–ü—Ä–æ–º–µ–Ω—è—à —Å–µ", s:"–†–∞–∑–≤–∏—Ç–∏–µ"},
        {d:"–ò–∑–∫—Ä–∏–≤—è–≤–∞–Ω–µ", a:"–ü—Ä–µ—á—É–ø–≤–∞—à", s:"–û–ø—Ç–∏—á–µ–Ω"},
        {d:"–ò–ª—é–∑–∏—è", a:"–ó–∞–±–ª—É–∂–¥–∞–≤–∞—à", s:"–í–∏–∑–∏—è"},
        {d:"–°–∏–º–±–∏–æ–∑–∞", a:"–°–ª–∏–≤–∞—à —Å–µ", s:"–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç"},
        {d:"–í–∏–±—Ä–∞—Ü–∏—è", a:"–¢—Ä–µ–ø–µ—Ä–∏—à", s:"–ß–µ—Å—Ç–æ—Ç–∞"},
        {d:"–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è", a:"–ü—Ä–∏–≤–ª–∏—á–∞—à", s:"–°–∏–ª–∞"},
        {d:"–ú–µ—Ç–∞–º–æ—Ä—Ñ–æ–∑–∞", a:"–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–∞—à", s:"–ö–∞–∫–∞–≤–∏–¥–∞"},
        {d:"–ü–∞—Ä–∞–ª–µ–ª", a:"–†–∞–≤–Ω–æ–≤–µ—Å–∏–µ", s:"–°—Ö–æ–¥—Å—Ç–≤–æ"},
        {d:"–†–µ–∑–æ–Ω–∞–Ω—Å", a:"–ï—Ö–æ", s:"–ó–≤—É–∫"},
        {d:"–§—Ä–∞–≥–º–µ–Ω—Ç", a:"–ß—É–ø–∏—à", s:"–ß–∞—Å—Ç"},
        {d:"–•–∏–ø–Ω–æ–∑–∞", a:"–ü—Ä–∏—Å–ø–∏–≤–∞—à", s:"–¢—Ä–∞–Ω—Å"},
        {d:"–ò–º–ø—É–ª—Å", a:"–¢–ª–∞—Å—ä–∫", s:"–†–µ–∞–∫—Ü–∏—è"},
        {d:"–ú–∏—Ä–∞–∂", a:"–ò–∑—á–µ–∑–≤–∞—à", s:"–ü—É—Å—Ç–∏–Ω—è"},
        {d:"–ï–Ω–∏–≥–º–∞", a:"–ó–∞–∫–ª—é—á–≤–∞—à", s:"–ó–∞–≥–∞–¥–∫–∞"},
        {d:"–ü—Ä–æ–µ–∫—Ü–∏—è", a:"–ò–∑–ª—ä—á–≤–∞—à", s:"–û–±—Ä–∞–∑"},
        {d:"–ë–∞–ª–∞–Ω—Å", a:"–ë–∞–ª–∞–Ω—Å–∏—Ä–∞—à", s:"–°—Ç–∞–±–∏–ª–Ω–æ—Å—Ç"},
        {d:"–ò–Ω–µ—Ä—Ü–∏—è", a:"–ü—Ä–æ–¥—ä–ª–∂–∞–≤–∞—à", s:"–î–≤–∏–∂–µ–Ω–∏–µ"},
        {d:"–í–∏–∑–∏—è", a:"–ü—Ä–µ–¥–≤–∏–∂–¥–∞—à", s:"–ë—ä–¥–µ—â–µ"},
        {d:"–ú–∞—Ç–µ—Ä–∏—è", a:"–û—Ñ–æ—Ä–º—è—à", s:"–§–∏–∑–∏–∫–∞"},
        {d:"–î—É—à–∞", a:"–õ–µ—Ç–∏—à", s:"–í—ä—Ç—Ä–µ—à–µ–Ω"},
        {d:"–í—Ä–µ–º–µ", a:"–ß–∞–∫–∞—à", s:"–í–µ—á–Ω–æ—Å—Ç"},
        {d:"–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ", a:"–†–∞–∑—à–∏—Ä—è–≤–∞—à", s:"–ö–æ—Å–º–æ—Å"},
        {d:"–ï–≥–æ", a:"–ì–æ—Ä–¥–µ–µ—à —Å–µ", s:"–õ–∏—á–Ω–æ—Å—Ç"},
        {d:"–ö–æ–Ω—Ñ–ª–∏–∫—Ç", a:"–°–±–ª—ä—Å–∫–≤–∞—à —Å–µ", s:"–ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ"},
        {d:"–ò–Ω—Ç—É–∏—Ü–∏—è", a:"–£—Å–µ—â–∞—à", s:"–ü—Ä–µ–¥—á—É–≤—Å—Ç–≤–∏–µ"},
        {d:"–ì–µ–Ω–µ—Ç–∏–∫–∞", a:"–ù–∞—Å–ª–µ–¥—è–≤–∞—à", s:"–î–ù–ö"},
        {d:"–ú–∏—Å—Ç–µ—Ä–∏—è", a:"–®–µ–ø–Ω–µ—à", s:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},
        {d:"–°—Ç—Ä—É–∫—Ç—É—Ä–∞", a:"–ì—Ä–∞–¥—è", s:"–û—Å–Ω–æ–≤–∞"},
        {d:"–ï—Ñ–µ–∫—Ç", a:"–°–ª–µ–¥—Å—Ç–≤–∏–µ", s:"–†–µ–∑—É–ª—Ç–∞—Ç"},
        {d:"–ü—Ä–∏—á–∏–Ω–∞", a:"–ù–∞—á–∞–ª–æ", s:"–û–±—è—Å–Ω–µ–Ω–∏–µ"},
        {d:"–°–∏—Å—Ç–µ–º–∞", a:"–°–≤—ä—Ä–∑–≤–∞—à", s:"–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è"},
        {d:"–¢–µ–æ—Ä–∏—è", a:"–ú–∏—Å–ª–∏—à", s:"–•–∏–ø–æ—Ç–µ–∑–∞"},
        {d:"–§–∞–∫—Ç", a:"–î–æ–∫–∞–∑–≤–∞—à", s:"–†–µ–∞–ª–Ω–æ—Å—Ç"},
        {d:"–ï–ª–µ–º–µ–Ω—Ç", a:"–°—ä–±–∏—Ä–∞—à", s:"–°—ä—Å—Ç–∞–≤–Ω–∞ —á–∞—Å—Ç"}]
    };

    const firebaseConfig = {
        apiKey: "AIzaSyC98brPgVFU1QIFpE9Q8N61xDiarrFERhM",
        authDomain: "my-activity-d2bc5.firebaseapp.com",
        databaseURL: "https://my-activity-d2bc5-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "my-activity-d2bc5",
        storageBucket: "my-activity-d2bc5.firebasestorage.app",
        messagingSenderId: "940491408918",
        appId: "1:940491408918:web:c7b521d5e36f7711bc5737"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database().ref("game_session_v6");

    let currentLevelPoints = 0;
    let timerInterval = null;

    function toggleMenu() { document.getElementById("side-menu").classList.toggle("active"); }

    db.on("value", (snap) => {
        const data = snap.val();
        if(!data) {
            db.set({ teams: [{name:"–°–ò–ù–ò", score:0, color:"#00d2ff"}, {name:"–ß–ï–†–í–ï–ù–ò", score:0, color:"#ff4b2b"}], timer:60, title:"üéÆ My Activity", cardsLocked:true, timerRunning:false });
            return;
        }

        document.getElementById("timer").textContent = data.timer;
        document.getElementById("game-title").innerHTML = data.title;
        
        if(data.cardsLocked) document.getElementById("decks-wrapper").classList.add("locked");
        else document.getElementById("decks-wrapper").classList.remove("locked");

        if(!data.timerRunning && timerInterval) { clearInterval(timerInterval); timerInterval = null; }

        const sbUI = document.getElementById("scoreboard-ui");
        const selUI = document.getElementById("score-selection");
        sbUI.innerHTML = ""; selUI.innerHTML = "";

        data.teams.forEach((t, i) => {
            sbUI.innerHTML += `<div class="score-box" style="border-color:${t.color}"><button class="btn-del" onclick="removeTeam(${i})">‚úï</button><span>${t.name}</span><span class="score-number">${t.score}</span></div>`;
            selUI.innerHTML += `<button class="team-point-btn" style="background:${t.color}" onclick="addPointsToTeam(${i})">${t.name} (+${currentLevelPoints})</button>`;
        });
    });

    function selectDeck(lvl, el) {
        const currentCard = cards[lvl].shift();
        cards[lvl].push(currentCard);
        currentLevelPoints = lvl;

        db.update({ cardsLocked: true });
        document.getElementById("t-btn").disabled = false;

        document.querySelectorAll(".deck-container").forEach(d => d !== el && d.classList.add("hidden"));
        el.classList.add("selected");
        el.querySelector(".deck").classList.add("flipped");

        el.querySelector(".deck-back").innerHTML = `
            <div class="card-content">
                <div class="card-row"><span>üé®</span><span>${currentCard.d}</span></div>
                <div class="card-row"><span>üé≠</span><span>${currentCard.a}</span></div>
                <div class="card-row"><span>üó£</span><span>${currentCard.s}</span></div>
            </div>`;
        
        document.getElementById("success-area").style.display = "flex";
        document.getElementById("success-label").style.display = "block";
        document.getElementById("score-selection").style.display = "none";
    }

    function rollDice() {
        const ops = [{i:"üé®", t:"–†–∏—Å—É–≤–∞–π"}, {i:"üé≠", t:"–ü–æ–∫–∞–∂–∏"}, {i:"üó£", t:"–û–±—è—Å–Ω–∏"}];
        let c = 0;
        const iv = setInterval(() => {
            const p = ops[Math.floor(Math.random()*3)];
            document.getElementById("game-title").innerHTML = `<span>${p.i}</span> ${p.t}`;
            if(c++ > 12) { clearInterval(iv); db.update({ title: document.getElementById("game-title").innerHTML, cardsLocked: false }); }
        }, 70);
    }

    function startTimer() {
        let t = 60; db.update({ timerRunning: true });
        timerInterval = setInterval(() => {
            t--; db.update({ timer: t });
            if(t <= 0) { clearInterval(timerInterval); db.update({ timerRunning: false }); }
        }, 1000);
    }

    function stopTimerAndShowScores() {
        // 1. –°–ø–∏—Ä–∞–º–µ —Ç–∞–π–º–µ—Ä–∞
        db.update({ timerRunning: false });
        // 2. –°–∫—Ä–∏–≤–∞–º–µ "–ü–û–ó–ù–ê–¢–û"
        document.getElementById("success-label").style.display = "none";
        // 3. –ü–û–ö–ê–ó–í–ê–ú–ï –æ—Ç–±–æ—Ä–∏—Ç–µ –∑–∞ –≥–ª–∞—Å—É–≤–∞–Ω–µ
        document.getElementById("score-selection").style.display = "grid";
    }

    function addPointsToTeam(index) {
        document.getElementById("loading").style.display = "flex";
        db.child("teams").once("value", snap => {
            const teams = snap.val();
            teams[index].score += currentLevelPoints;
            db.child("teams").set(teams).then(() => {
                setTimeout(() => {
                    document.getElementById("loading").style.display = "none";
                    resetCloud();
                }, 500);
            });
        });
    }

    function resetCloud() {
        db.update({ title: "üéÆ My Activity", timer: 60, cardsLocked: true, timerRunning: false });
        document.getElementById("t-btn").disabled = true;
        document.getElementById("success-area").style.display = "none";
        document.querySelectorAll(".deck-container").forEach(d => {
            d.classList.remove("hidden", "selected");
            d.querySelector(".deck").classList.remove("flipped");
        });
    }

    // –ú–ï–ù–Æ –§–£–ù–ö–¶–ò–ò
    function createNewTeam() {
        const name = document.getElementById("team-name-input").value;
        if(!name) return;
        db.child("teams").once("value", snap => {
            const teams = snap.val() || [];
            const colors = ["#00d2ff", "#ff4b2b", "#28a745", "#ffc107", "#e83e8c"];
            teams.push({ name: name, score: 0, color: colors[teams.length % colors.length] });
            db.child("teams").set(teams);
            document.getElementById("team-name-input").value = "";
            toggleMenu();
        });
    }
    function removeTeam(index) {
        db.child("teams").once("value", snap => {
            const teams = snap.val();
            teams.splice(index, 1);
            db.child("teams").set(teams);
        });
    }
    function resetGlobalScores() {
        db.child("teams").once("value", snap => {
            const teams = snap.val().map(t => ({ ...t, score: 0 }));
            db.child("teams").set(teams);
            toggleMenu();
            resetCloud();
        });
    }
</script>
</body>

</html>
